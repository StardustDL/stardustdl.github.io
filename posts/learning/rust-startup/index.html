<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="安装 https://www.rust-lang.org/tools/install
 安装管理器 rustup 编译器 rustc 构建系统与包管理器 cargo  常用命令  创建项目 cargo new {name} 可编译检查 cargo check 编译 cargo build (--release) 运行 cargo run 更新依赖包小版本 cargo upgrade （大版本需要手动修改）  变量 letimmutable_var: i32 =5;letmutmutable_var: i32 =5;constCONST: u32 =100_000;数值字面值
 十进制 98_222 十六进制 0xff 八进制 0o77 二进制 0b1111_0000 字节 b'A'  类型  数值类型 i8, i16, i32, i64, i128, isize, u8, u16, u32, u64, u128, usize, f32, f64 布尔类型 bool 字符类型 char 四字节 元组类型 (T1, T2, ."><title>Rust 语言基础使用</title><link rel=canonical href=https://stardustdl.github.io/posts/learning/rust-startup/><link rel=stylesheet href=/scss/style.min.css><meta property="og:title" content="Rust 语言基础使用"><meta property="og:description" content="安装 https://www.rust-lang.org/tools/install
 安装管理器 rustup 编译器 rustc 构建系统与包管理器 cargo  常用命令  创建项目 cargo new {name} 可编译检查 cargo check 编译 cargo build (--release) 运行 cargo run 更新依赖包小版本 cargo upgrade （大版本需要手动修改）  变量 letimmutable_var: i32 =5;letmutmutable_var: i32 =5;constCONST: u32 =100_000;数值字面值
 十进制 98_222 十六进制 0xff 八进制 0o77 二进制 0b1111_0000 字节 b'A'  类型  数值类型 i8, i16, i32, i64, i128, isize, u8, u16, u32, u64, u128, usize, f32, f64 布尔类型 bool 字符类型 char 四字节 元组类型 (T1, T2, ."><meta property="og:url" content="https://stardustdl.github.io/posts/learning/rust-startup/"><meta property="og:site_name" content="StardustDL's Blog"><meta property="og:type" content="article"><meta property="article:section" content="Posts"><meta property="article:tag" content="Rust"><meta property="article:tag" content="编程语言"><meta property="article:published_time" content="2021-07-06T09:42:46+08:00"><meta property="article:modified_time" content="2021-07-06T09:42:46+08:00"><meta name=twitter:title content="Rust 语言基础使用"><meta name=twitter:description content="安装 https://www.rust-lang.org/tools/install
 安装管理器 rustup 编译器 rustc 构建系统与包管理器 cargo  常用命令  创建项目 cargo new {name} 可编译检查 cargo check 编译 cargo build (--release) 运行 cargo run 更新依赖包小版本 cargo upgrade （大版本需要手动修改）  变量 letimmutable_var: i32 =5;letmutmutable_var: i32 =5;constCONST: u32 =100_000;数值字面值
 十进制 98_222 十六进制 0xff 八进制 0o77 二进制 0b1111_0000 字节 b'A'  类型  数值类型 i8, i16, i32, i64, i128, isize, u8, u16, u32, u64, u128, usize, f32, f64 布尔类型 bool 字符类型 char 四字节 元组类型 (T1, T2, ."><link rel="shortcut icon" href=/favicon.png><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-111573521-1','auto'),ga('send','pageview'))</script></head><body class="article-page has-toc"><script>(function(){const a='StackColorScheme';localStorage.getItem(a)||localStorage.setItem(a,"auto")})()</script><script>(function(){const b='StackColorScheme',a=localStorage.getItem(b),c=window.matchMedia('(prefers-color-scheme: dark)').matches===!0;a=='dark'||a==='auto'&&c?document.documentElement.dataset.scheme='dark':document.documentElement.dataset.scheme='light'})()</script><div class="container main-container flex
extended"><div id=article-toolbar><a href=https://stardustdl.github.io/ class=back-home><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18"/></svg><span>Back</span></a></div><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/learning/>Learning</a></header><h2 class=article-title><a href=/posts/learning/rust-startup/>Rust 语言基础使用</a></h2><footer class=article-time><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--published>Jul 06, 2021</time></footer></div></header><section class=article-content><h1 id=安装>安装</h1><p><a href=https://www.rust-lang.org/tools/install>https://www.rust-lang.org/tools/install</a></p><ul><li>安装管理器 <code>rustup</code></li><li>编译器 <code>rustc</code></li><li>构建系统与包管理器 <code>cargo</code></li></ul><h2 id=常用命令>常用命令</h2><ul><li>创建项目 <code>cargo new {name}</code></li><li>可编译检查 <code>cargo check</code></li><li>编译 <code>cargo build (--release)</code></li><li>运行 <code>cargo run</code></li><li>更新依赖包小版本 <code>cargo upgrade</code> （大版本需要手动修改）</li></ul><h1 id=变量>变量</h1><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=kd>let</span><span class=w> </span><span class=n>immutable_var</span>: <span class=kt>i32</span> <span class=o>=</span><span class=w> </span><span class=mi>5</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>mutable_var</span>: <span class=kt>i32</span> <span class=o>=</span><span class=w> </span><span class=mi>5</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=k>const</span><span class=w> </span><span class=n>CONST</span>: <span class=kt>u32</span> <span class=o>=</span><span class=w> </span><span class=mi>100_000</span><span class=p>;</span><span class=w>
</span></code></pre></div><p>数值字面值</p><ul><li>十进制 <code>98_222</code></li><li>十六进制 <code>0xff</code></li><li>八进制 <code>0o77</code></li><li>二进制 <code>0b1111_0000</code></li><li>字节 <code>b'A'</code></li></ul><h1 id=类型>类型</h1><ul><li>数值类型 <code>i8, i16, i32, i64, i128, isize, u8, u16, u32, u64, u128, usize, f32, f64</code></li><li>布尔类型 <code>bool</code></li><li>字符类型 <code>char</code> 四字节</li><li>元组类型 <code>(T1, T2, ...) = (1, 2, 3)</code></li><li>数组类型 <code>[i32; 5] = [1, 2, 3, 4, 5]</code></li></ul><h1 id=结构体>结构体</h1><h2 id=定义>定义</h2><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=k>struct</span> <span class=nc>User</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>username</span>: <span class=nb>String</span><span class=p>,</span><span class=w>
</span><span class=w>    </span><span class=n>email</span>: <span class=nb>String</span><span class=p>,</span><span class=w>
</span><span class=w>    </span><span class=n>sign_in_count</span>: <span class=kt>u64</span><span class=p>,</span><span class=w>
</span><span class=w>    </span><span class=n>active</span>: <span class=kt>bool</span><span class=p>,</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>struct</span> <span class=nc>Color</span><span class=p>(</span><span class=kt>i32</span><span class=p>,</span><span class=w> </span><span class=kt>i32</span><span class=p>,</span><span class=w> </span><span class=kt>i32</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=k>struct</span> <span class=nc>Point</span><span class=p>(</span><span class=kt>i32</span><span class=p>,</span><span class=w> </span><span class=kt>i32</span><span class=p>,</span><span class=w> </span><span class=kt>i32</span><span class=p>);</span><span class=w>
</span></code></pre></div><h2 id=实例化>实例化</h2><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=kd>let</span><span class=w> </span><span class=n>user1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>User</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>email</span>: <span class=nb>String</span>::<span class=n>from</span><span class=p>(</span><span class=s>&#34;someone@example.com&#34;</span><span class=p>),</span><span class=w>
</span><span class=w>    </span><span class=n>username</span>: <span class=nb>String</span>::<span class=n>from</span><span class=p>(</span><span class=s>&#34;someusername123&#34;</span><span class=p>),</span><span class=w>
</span><span class=w>    </span><span class=n>active</span>: <span class=nc>true</span><span class=p>,</span><span class=w>
</span><span class=w>    </span><span class=n>sign_in_count</span>: <span class=mi>1</span><span class=p>,</span><span class=w>
</span><span class=w></span><span class=p>};</span><span class=w>
</span></code></pre></div><h2 id=成员修改>成员修改</h2><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>user1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>User</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>email</span>: <span class=nb>String</span>::<span class=n>from</span><span class=p>(</span><span class=s>&#34;someone@example.com&#34;</span><span class=p>),</span><span class=w>
</span><span class=w>    </span><span class=n>username</span>: <span class=nb>String</span>::<span class=n>from</span><span class=p>(</span><span class=s>&#34;someusername123&#34;</span><span class=p>),</span><span class=w>
</span><span class=w>    </span><span class=n>active</span>: <span class=nc>true</span><span class=p>,</span><span class=w>
</span><span class=w>    </span><span class=n>sign_in_count</span>: <span class=mi>1</span><span class=p>,</span><span class=w>
</span><span class=w></span><span class=p>};</span><span class=w>
</span><span class=w></span><span class=n>user1</span><span class=p>.</span><span class=n>email</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>String</span>::<span class=n>from</span><span class=p>(</span><span class=s>&#34;anotheremail@example.com&#34;</span><span class=p>);</span><span class=w>
</span></code></pre></div><h2 id=基于现有结构更新>基于现有结构更新</h2><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=kd>let</span><span class=w> </span><span class=n>user2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>User</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>email</span>: <span class=nb>String</span>::<span class=n>from</span><span class=p>(</span><span class=s>&#34;another@example.com&#34;</span><span class=p>),</span><span class=w>
</span><span class=w>    </span><span class=n>username</span>: <span class=nb>String</span>::<span class=n>from</span><span class=p>(</span><span class=s>&#34;anotherusername567&#34;</span><span class=p>),</span><span class=w>
</span><span class=w>    </span><span class=p>..</span><span class=n>user1</span><span class=w>
</span><span class=w></span><span class=p>};</span><span class=w>
</span></code></pre></div><h1 id=枚举>枚举</h1><h2 id=简单枚举>简单枚举</h2><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=k>enum</span> <span class=nc>IpAddrKind</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>V4</span><span class=p>,</span><span class=w>
</span><span class=w>    </span><span class=n>V6</span><span class=p>,</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=kd>let</span><span class=w> </span><span class=n>four</span>: <span class=nc>IpAddrKind</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>IpAddrKind</span>::<span class=n>V4</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=kd>let</span><span class=w> </span><span class=n>six</span>: <span class=nc>IpAddrKind</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>IpAddrKind</span>::<span class=n>V6</span><span class=p>;</span><span class=w>
</span></code></pre></div><h2 id=数据枚举>数据枚举</h2><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=k>enum</span> <span class=nc>IpAddr</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>V4</span><span class=p>(</span><span class=kt>u8</span><span class=p>,</span><span class=w> </span><span class=kt>u8</span><span class=p>,</span><span class=w> </span><span class=kt>u8</span><span class=p>,</span><span class=w> </span><span class=kt>u8</span><span class=p>),</span><span class=w>
</span><span class=w>    </span><span class=n>V6</span><span class=p>(</span><span class=nb>String</span><span class=p>),</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=kd>let</span><span class=w> </span><span class=n>home</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>IpAddr</span>::<span class=n>V4</span><span class=p>(</span><span class=mi>127</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=kd>let</span><span class=w> </span><span class=n>loopback</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>IpAddr</span>::<span class=n>V6</span><span class=p>(</span><span class=nb>String</span>::<span class=n>from</span><span class=p>(</span><span class=s>&#34;::1&#34;</span><span class=p>));</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>enum</span> <span class=nc>Message</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>Quit</span><span class=p>,</span><span class=w>
</span><span class=w>    </span><span class=n>Move</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>x</span>: <span class=kt>i32</span><span class=p>,</span><span class=w> </span><span class=n>y</span>: <span class=kt>i32</span> <span class=p>},</span><span class=w>
</span><span class=w>    </span><span class=n>Write</span><span class=p>(</span><span class=nb>String</span><span class=p>),</span><span class=w>
</span><span class=w>    </span><span class=n>ChangeColor</span><span class=p>(</span><span class=kt>i32</span><span class=p>,</span><span class=w> </span><span class=kt>i32</span><span class=p>,</span><span class=w> </span><span class=kt>i32</span><span class=p>),</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span></code></pre></div><h1 id=控制流>控制流</h1><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=c1>// 分支
</span><span class=c1></span><span class=w>
</span><span class=w></span><span class=k>if</span><span class=w> </span><span class=n>number</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=mi>4</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;number is divisible by 4&#34;</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=n>number</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=mi>3</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;number is divisible by 3&#34;</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;number is not divisible by 4 or 3&#34;</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=kd>let</span><span class=w> </span><span class=n>number</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=n>condition</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=mi>5</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=s>&#34;six&#34;</span><span class=w> </span><span class=p>};</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=c1>// 循环
</span><span class=c1></span><span class=w>
</span><span class=w></span><span class=k>loop</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;again!&#34;</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=kd>let</span><span class=w> </span><span class=n>result</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>loop</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>counter</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span><span class=w>
</span><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=n>counter</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>10</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=k>break</span><span class=w> </span><span class=n>counter</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>2</span><span class=p>;</span><span class=w>
</span><span class=w>    </span><span class=p>}</span><span class=w>
</span><span class=w></span><span class=p>};</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>while</span><span class=w> </span><span class=n>number</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;{}!&#34;</span><span class=p>,</span><span class=w> </span><span class=n>number</span><span class=p>);</span><span class=w>
</span><span class=w>
</span><span class=w>    </span><span class=n>number</span><span class=w> </span><span class=o>-=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>for</span><span class=w> </span><span class=n>number</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=p>..</span><span class=mi>4</span><span class=p>).</span><span class=n>rev</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;{}!&#34;</span><span class=p>,</span><span class=w> </span><span class=n>number</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span></code></pre></div><h1 id=模式匹配>模式匹配</h1><h2 id=模式>模式</h2><p>模式有可反驳和不可反驳（对所有传入的值都满足模式）两种。</p><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=c1>// 字面值
</span><span class=c1></span><span class=w>
</span><span class=w></span><span class=kd>let</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=k>match</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=mi>1</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;one&#34;</span><span class=p>),</span><span class=w>
</span><span class=w>    </span><span class=mi>2</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;two&#34;</span><span class=p>),</span><span class=w>
</span><span class=w>    </span><span class=mi>3</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;three&#34;</span><span class=p>),</span><span class=w>
</span><span class=w>    </span><span class=n>_</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;anything&#34;</span><span class=p>),</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=c1>// 具名变量
</span><span class=c1></span><span class=w>
</span><span class=w></span><span class=kd>let</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>Some</span><span class=p>(</span><span class=mi>5</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=k>match</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=nb>Some</span><span class=p>(</span><span class=mi>50</span><span class=p>)</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;Got 50&#34;</span><span class=p>),</span><span class=w>
</span><span class=w>    </span><span class=nb>Some</span><span class=p>(</span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;Matched, y = {:?}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>y</span><span class=p>),</span><span class=w>
</span><span class=w>    </span><span class=n>_</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;Default case, x = {:?}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>x</span><span class=p>),</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=c1>// 多重匹配（或）
</span><span class=c1></span><span class=w>
</span><span class=w></span><span class=kd>let</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=k>match</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;one or two&#34;</span><span class=p>),</span><span class=w>
</span><span class=w>    </span><span class=mi>3</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;three&#34;</span><span class=p>),</span><span class=w>
</span><span class=w>    </span><span class=n>_</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;anything&#34;</span><span class=p>),</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=c1>// 值区间匹配
</span><span class=c1></span><span class=w>
</span><span class=w></span><span class=kd>let</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>5</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=k>match</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=mi>1</span><span class=p>..</span><span class=o>=</span><span class=mi>5</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;one through five&#34;</span><span class=p>),</span><span class=w> </span><span class=c1>// equals to 1 | 2 | 3 | 4 | 5
</span><span class=c1></span><span class=w>    </span><span class=n>_</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;something else&#34;</span><span class=p>),</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=kd>let</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=sc>&#39;c&#39;</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=k>match</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=sc>&#39;a&#39;</span><span class=p>..</span><span class=o>=</span><span class=sc>&#39;j&#39;</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;early ASCII letter&#34;</span><span class=p>),</span><span class=w>
</span><span class=w>    </span><span class=sc>&#39;k&#39;</span><span class=p>..</span><span class=o>=</span><span class=sc>&#39;z&#39;</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;late ASCII letter&#34;</span><span class=p>),</span><span class=w>
</span><span class=w>    </span><span class=n>_</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;something else&#34;</span><span class=p>),</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=c1>// 解构
</span><span class=c1></span><span class=w>
</span><span class=w></span><span class=kd>let</span><span class=w> </span><span class=n>p</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Point</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>x</span>: <span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=n>y</span>: <span class=mi>7</span><span class=w> </span><span class=p>};</span><span class=w>
</span><span class=w></span><span class=kd>let</span><span class=w> </span><span class=n>Point</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>x</span>: <span class=nc>a</span><span class=p>,</span><span class=w> </span><span class=n>y</span>: <span class=nc>b</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=n>assert_eq</span><span class=o>!</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=n>a</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=n>assert_eq</span><span class=o>!</span><span class=p>(</span><span class=mi>7</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>);</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>match</span><span class=w> </span><span class=n>p</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>Point</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=n>y</span>: <span class=mi>0</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;On the x axis at {}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>x</span><span class=p>),</span><span class=w>
</span><span class=w>    </span><span class=n>Point</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>x</span>: <span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;On the y axis at {}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>y</span><span class=p>),</span><span class=w>
</span><span class=w>    </span><span class=n>Point</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;On neither axis: ({}, {})&#34;</span><span class=p>,</span><span class=w> </span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=n>y</span><span class=p>),</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>match</span><span class=w> </span><span class=n>msg</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>Message</span>::<span class=n>Quit</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;The Quit variant has no data to destructure.&#34;</span><span class=p>)</span><span class=w>
</span><span class=w>    </span><span class=p>}</span><span class=w>
</span><span class=w>    </span><span class=n>Message</span>::<span class=n>Move</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=w>
</span><span class=w>            </span><span class=s>&#34;Move in the x direction {} and in the y direction {}&#34;</span><span class=p>,</span><span class=w>
</span><span class=w>            </span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=n>y</span><span class=w>
</span><span class=w>        </span><span class=p>);</span><span class=w>
</span><span class=w>    </span><span class=p>}</span><span class=w>
</span><span class=w>    </span><span class=n>Message</span>::<span class=n>Write</span><span class=p>(</span><span class=n>text</span><span class=p>)</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;Text message: {}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>text</span><span class=p>),</span><span class=w>
</span><span class=w>    </span><span class=n>Message</span>::<span class=n>ChangeColor</span><span class=p>(</span><span class=n>r</span><span class=p>,</span><span class=w> </span><span class=n>g</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>)</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=w>
</span><span class=w>        </span><span class=s>&#34;Change the color to red {}, green {}, and blue {}&#34;</span><span class=p>,</span><span class=w>
</span><span class=w>        </span><span class=n>r</span><span class=p>,</span><span class=w> </span><span class=n>g</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=w>
</span><span class=w>    </span><span class=p>),</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=c1>// 多层解构
</span><span class=c1></span><span class=k>enum</span> <span class=nc>Color</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>Rgb</span><span class=p>(</span><span class=kt>i32</span><span class=p>,</span><span class=w> </span><span class=kt>i32</span><span class=p>,</span><span class=w> </span><span class=kt>i32</span><span class=p>),</span><span class=w>
</span><span class=w>    </span><span class=n>Hsv</span><span class=p>(</span><span class=kt>i32</span><span class=p>,</span><span class=w> </span><span class=kt>i32</span><span class=p>,</span><span class=w> </span><span class=kt>i32</span><span class=p>),</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>enum</span> <span class=nc>Message</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>Quit</span><span class=p>,</span><span class=w>
</span><span class=w>    </span><span class=n>Move</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>x</span>: <span class=kt>i32</span><span class=p>,</span><span class=w> </span><span class=n>y</span>: <span class=kt>i32</span> <span class=p>},</span><span class=w>
</span><span class=w>    </span><span class=n>Write</span><span class=p>(</span><span class=nb>String</span><span class=p>),</span><span class=w>
</span><span class=w>    </span><span class=n>ChangeColor</span><span class=p>(</span><span class=n>Color</span><span class=p>),</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>msg</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Message</span>::<span class=n>ChangeColor</span><span class=p>(</span><span class=n>Color</span>::<span class=n>Hsv</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>160</span><span class=p>,</span><span class=w> </span><span class=mi>255</span><span class=p>));</span><span class=w>
</span><span class=w>
</span><span class=w>    </span><span class=k>match</span><span class=w> </span><span class=n>msg</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=n>Message</span>::<span class=n>ChangeColor</span><span class=p>(</span><span class=n>Color</span>::<span class=n>Rgb</span><span class=p>(</span><span class=n>r</span><span class=p>,</span><span class=w> </span><span class=n>g</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>))</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=w>
</span><span class=w>            </span><span class=s>&#34;Change the color to red {}, green {}, and blue {}&#34;</span><span class=p>,</span><span class=w>
</span><span class=w>            </span><span class=n>r</span><span class=p>,</span><span class=w> </span><span class=n>g</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=w>
</span><span class=w>        </span><span class=p>),</span><span class=w>
</span><span class=w>        </span><span class=n>Message</span>::<span class=n>ChangeColor</span><span class=p>(</span><span class=n>Color</span>::<span class=n>Hsv</span><span class=p>(</span><span class=n>h</span><span class=p>,</span><span class=w> </span><span class=n>s</span><span class=p>,</span><span class=w> </span><span class=n>v</span><span class=p>))</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=w>
</span><span class=w>            </span><span class=s>&#34;Change the color to hue {}, saturation {}, and value {}&#34;</span><span class=p>,</span><span class=w>
</span><span class=w>            </span><span class=n>h</span><span class=p>,</span><span class=w> </span><span class=n>s</span><span class=p>,</span><span class=w> </span><span class=n>v</span><span class=w>
</span><span class=w>        </span><span class=p>),</span><span class=w>
</span><span class=w>        </span><span class=n>_</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>(),</span><span class=w>
</span><span class=w>    </span><span class=p>}</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=kd>let</span><span class=w> </span><span class=p>((</span><span class=n>feet</span><span class=p>,</span><span class=w> </span><span class=n>inches</span><span class=p>),</span><span class=w> </span><span class=n>Point</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>((</span><span class=mi>3</span><span class=p>,</span><span class=w> </span><span class=mi>10</span><span class=p>),</span><span class=w> </span><span class=n>Point</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>x</span>: <span class=mi>3</span><span class=p>,</span><span class=w> </span><span class=n>y</span>: <span class=o>-</span><span class=mi>10</span><span class=w> </span><span class=p>});</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=c1>// 多级模式 @
</span><span class=c1></span><span class=w>
</span><span class=w></span><span class=k>enum</span> <span class=nc>Message</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>Hello</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>id</span>: <span class=kt>i32</span> <span class=p>},</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=kd>let</span><span class=w> </span><span class=n>msg</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Message</span>::<span class=n>Hello</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>id</span>: <span class=mi>5</span><span class=w> </span><span class=p>};</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>match</span><span class=w> </span><span class=n>msg</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>Message</span>::<span class=n>Hello</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=n>id</span>: <span class=nc>id_variable</span><span class=w> </span><span class=o>@</span><span class=w> </span><span class=mi>3</span><span class=p>..</span><span class=o>=</span><span class=mi>7</span><span class=p>,</span><span class=w>
</span><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;Found an id in range: {}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>id_variable</span><span class=p>),</span><span class=w>
</span><span class=w>    </span><span class=n>Message</span>::<span class=n>Hello</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>id</span>: <span class=mi>10</span><span class=p>..</span><span class=o>=</span><span class=mi>12</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;Found an id in another range&#34;</span><span class=p>)</span><span class=w>
</span><span class=w>    </span><span class=p>}</span><span class=w>
</span><span class=w>    </span><span class=n>Message</span>::<span class=n>Hello</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;Found some other id: {}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>id</span><span class=p>),</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=c1>// 忽略
</span><span class=c1></span><span class=w>
</span><span class=w></span><span class=k>fn</span> <span class=nf>foo</span><span class=p>(</span><span class=n>_</span>: <span class=kt>i32</span><span class=p>,</span><span class=w> </span><span class=n>y</span>: <span class=kt>i32</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;This code only uses the y parameter: {}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>y</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w></span><span class=k>match</span><span class=w> </span><span class=p>(</span><span class=n>setting_value</span><span class=p>,</span><span class=w> </span><span class=n>new_setting_value</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=p>(</span><span class=nb>Some</span><span class=p>(</span><span class=n>_</span><span class=p>),</span><span class=w> </span><span class=nb>Some</span><span class=p>(</span><span class=n>_</span><span class=p>))</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;Can&#39;t overwrite an existing customized value&#34;</span><span class=p>);</span><span class=w>
</span><span class=w>    </span><span class=p>}</span><span class=w>
</span><span class=w>    </span><span class=n>_</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=n>setting_value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>new_setting_value</span><span class=p>;</span><span class=w>
</span><span class=w>    </span><span class=p>}</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w></span><span class=kd>let</span><span class=w> </span><span class=n>numbers</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>4</span><span class=p>,</span><span class=w> </span><span class=mi>8</span><span class=p>,</span><span class=w> </span><span class=mi>16</span><span class=p>,</span><span class=w> </span><span class=mi>32</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=k>match</span><span class=w> </span><span class=n>numbers</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=p>(</span><span class=n>first</span><span class=p>,</span><span class=w> </span><span class=n>_</span><span class=p>,</span><span class=w> </span><span class=n>third</span><span class=p>,</span><span class=w> </span><span class=n>_</span><span class=p>,</span><span class=w> </span><span class=n>fifth</span><span class=p>)</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;Some numbers: {}, {}, {}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>first</span><span class=p>,</span><span class=w> </span><span class=n>third</span><span class=p>,</span><span class=w> </span><span class=n>fifth</span><span class=p>)</span><span class=w>
</span><span class=w>    </span><span class=p>}</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w></span><span class=k>match</span><span class=w> </span><span class=n>numbers</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=p>(</span><span class=n>first</span><span class=p>,</span><span class=w> </span><span class=p>..,</span><span class=w> </span><span class=n>last</span><span class=p>)</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;Some numbers: {}, {}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>first</span><span class=p>,</span><span class=w> </span><span class=n>last</span><span class=p>);</span><span class=w>
</span><span class=w>    </span><span class=p>}</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w></span><span class=kd>let</span><span class=w> </span><span class=n>origin</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Point</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>x</span>: <span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=n>y</span>: <span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=n>z</span>: <span class=mi>0</span><span class=w> </span><span class=p>};</span><span class=w>
</span><span class=w></span><span class=k>match</span><span class=w> </span><span class=n>origin</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>Point</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=p>..</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;x is {}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>x</span><span class=p>),</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>_x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>5</span><span class=p>;</span><span class=w> </span><span class=c1>// unused var to ignore warning when compiling
</span><span class=c1></span><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>10</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span></code></pre></div><h2 id=匹配>匹配</h2><p><code>let</code> 语句，函数参数，<code>for</code> 循环只接受不可反驳模式。
<code>match</code> 只接受可反驳模式。</p><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=c1>// 完全匹配，要求全面讨论情况，按前后顺序依次进行，匹配后不再进行后续
</span><span class=c1></span><span class=w>
</span><span class=w></span><span class=cp>#[derive(Debug)]</span><span class=w>
</span><span class=w></span><span class=k>enum</span> <span class=nc>UsState</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>Alabama</span><span class=p>,</span><span class=w>
</span><span class=w>    </span><span class=n>Alaska</span><span class=p>,</span><span class=w>
</span><span class=w>    </span><span class=c1>// --snip--
</span><span class=c1></span><span class=p>}</span><span class=w>
</span><span class=w></span><span class=k>enum</span> <span class=nc>Coin</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>Penny</span><span class=p>,</span><span class=w>
</span><span class=w>    </span><span class=n>Nickel</span><span class=p>,</span><span class=w>
</span><span class=w>    </span><span class=n>Dime</span><span class=p>,</span><span class=w>
</span><span class=w>    </span><span class=n>Quarter</span><span class=p>(</span><span class=n>UsState</span><span class=p>),</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>fn</span> <span class=nf>value_in_cents</span><span class=p>(</span><span class=n>coin</span>: <span class=nc>Coin</span><span class=p>)</span><span class=w> </span>-&gt; <span class=kt>u8</span> <span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=k>match</span><span class=w> </span><span class=n>coin</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=n>Coin</span>::<span class=n>Penny</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>            </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;Lucky penny!&#34;</span><span class=p>);</span><span class=w>
</span><span class=w>            </span><span class=mi>1</span><span class=w>
</span><span class=w>        </span><span class=p>},</span><span class=w>
</span><span class=w>        </span><span class=n>Coin</span>::<span class=n>Nickel</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=mi>5</span><span class=p>,</span><span class=w>
</span><span class=w>        </span><span class=n>Coin</span>::<span class=n>Dime</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=mi>10</span><span class=p>,</span><span class=w>
</span><span class=w>        </span><span class=n>Coin</span>::<span class=n>Quarter</span><span class=p>(</span><span class=n>state</span><span class=p>)</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>            </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;State quarter from {:?}!&#34;</span><span class=p>,</span><span class=w> </span><span class=n>state</span><span class=p>);</span><span class=w>
</span><span class=w>            </span><span class=mi>25</span><span class=w>
</span><span class=w>        </span><span class=p>}</span><span class=w>
</span><span class=w>        </span><span class=n>_</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w>
</span><span class=w>    </span><span class=p>}</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=kd>let</span><span class=w> </span><span class=n>num</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>Some</span><span class=p>(</span><span class=mi>4</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=k>match</span><span class=w> </span><span class=n>num</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=nb>Some</span><span class=p>(</span><span class=n>x</span><span class=p>)</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>5</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;less than five: {}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>x</span><span class=p>),</span><span class=w>
</span><span class=w>    </span><span class=nb>Some</span><span class=p>(</span><span class=n>x</span><span class=p>)</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;{}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>x</span><span class=p>),</span><span class=w>
</span><span class=w>    </span><span class=nb>None</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>(),</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=kd>let</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>4</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=kd>let</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>false</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=k>match</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=mi>4</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>5</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>6</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;yes&#34;</span><span class=p>),</span><span class=w> </span><span class=c1>// (4 | 5 | 6) if y
</span><span class=c1></span><span class=w>    </span><span class=n>_</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;no&#34;</span><span class=p>),</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=c1>// 单条件匹配 (if/while) let PATTERN = VALUE
</span><span class=c1></span><span class=w>
</span><span class=w></span><span class=kd>let</span><span class=w> </span><span class=n>some_u8_value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>Some</span><span class=p>(</span><span class=mi>0</span><span class=k>u8</span><span class=p>);</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>match</span><span class=w> </span><span class=n>some_u8_value</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=nb>Some</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;three&#34;</span><span class=p>),</span><span class=w>
</span><span class=w>    </span><span class=n>_</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>(),</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>if</span><span class=w> </span><span class=kd>let</span><span class=w> </span><span class=nb>Some</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>some_u8_value</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;three&#34;</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w></span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>stack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>Vec</span>::<span class=n>new</span><span class=p>();</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=n>stack</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=n>stack</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=mi>2</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=n>stack</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=mi>3</span><span class=p>);</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>while</span><span class=w> </span><span class=kd>let</span><span class=w> </span><span class=nb>Some</span><span class=p>(</span><span class=n>top</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>stack</span><span class=p>.</span><span class=n>pop</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;{}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>top</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=c1>// 解包匹配
</span><span class=c1></span><span class=w>
</span><span class=w></span><span class=kd>let</span><span class=w> </span><span class=n>v</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>vec</span><span class=o>!</span><span class=p>[</span><span class=sc>&#39;a&#39;</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;b&#39;</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;c&#39;</span><span class=p>];</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>index</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=n>v</span><span class=p>.</span><span class=n>iter</span><span class=p>().</span><span class=n>enumerate</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;{} is at index {}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=p>,</span><span class=w> </span><span class=n>index</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=kd>let</span><span class=w> </span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=n>y</span><span class=p>,</span><span class=w> </span><span class=n>z</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>3</span><span class=p>);</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>fn</span> <span class=nf>print_coordinates</span><span class=p>(</span><span class=o>&amp;</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=n>y</span><span class=p>)</span>: <span class=kp>&amp;</span><span class=p>(</span><span class=kt>i32</span><span class=p>,</span><span class=w> </span><span class=kt>i32</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;Current location: ({}, {})&#34;</span><span class=p>,</span><span class=w> </span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=n>y</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>point</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=mi>3</span><span class=p>,</span><span class=w> </span><span class=mi>5</span><span class=p>);</span><span class=w>
</span><span class=w>    </span><span class=n>print_coordinates</span><span class=p>(</span><span class=o>&amp;</span><span class=n>point</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span></code></pre></div><h1 id=函数>函数</h1><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=k>fn</span> <span class=nf>fnname</span><span class=p>(</span><span class=n>arg1</span>: <span class=kt>i32</span><span class=p>,</span><span class=w> </span><span class=n>arg2</span>:<span class=kt>u32</span><span class=p>)</span><span class=w> </span>-&gt; <span class=kt>u32</span> <span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=mi>5</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span></code></pre></div><h1 id=关联函数>关联函数</h1><p>关联函数是定义在结构，枚举和特征的上下文中的函数，不使用实例变量。</p><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=k>impl</span><span class=w> </span><span class=n>Rectangle</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=k>fn</span> <span class=nf>square</span><span class=p>(</span><span class=n>size</span>: <span class=kt>u32</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nc>Rectangle</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=n>Rectangle</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>            </span><span class=n>width</span>: <span class=nc>size</span><span class=p>,</span><span class=w>
</span><span class=w>            </span><span class=n>height</span>: <span class=nc>size</span><span class=p>,</span><span class=w>
</span><span class=w>        </span><span class=p>}</span><span class=w>
</span><span class=w>    </span><span class=p>}</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=kd>let</span><span class=w> </span><span class=n>r</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Rectangle</span>::<span class=n>square</span><span class=p>(</span><span class=mi>5</span><span class=p>);</span><span class=w>
</span></code></pre></div><h1 id=方法>方法</h1><p>方法是定义在结构，枚举和特征的上下文中的传入实例变量的函数，其第一个参数总是 <code>self</code> 代表了调用此方法的实例（可以使用不可变借用，可变借用，或获得所有权）。</p><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=cp>#[derive(Debug)]</span><span class=w>
</span><span class=w></span><span class=k>struct</span> <span class=nc>Rectangle</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>width</span>: <span class=kt>u32</span><span class=p>,</span><span class=w>
</span><span class=w>    </span><span class=n>height</span>: <span class=kt>u32</span><span class=p>,</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>impl</span><span class=w> </span><span class=n>Rectangle</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=k>fn</span> <span class=nf>area</span><span class=p>(</span><span class=o>&amp;</span><span class=bp>self</span><span class=p>)</span><span class=w> </span>-&gt; <span class=kt>u32</span> <span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=bp>self</span><span class=p>.</span><span class=n>width</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=bp>self</span><span class=p>.</span><span class=n>height</span><span class=w>
</span><span class=w>    </span><span class=p>}</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>rect1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Rectangle</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=n>width</span>: <span class=mi>30</span><span class=p>,</span><span class=w>
</span><span class=w>        </span><span class=n>height</span>: <span class=mi>50</span><span class=p>,</span><span class=w>
</span><span class=w>    </span><span class=p>};</span><span class=w>
</span><span class=w>
</span><span class=w>    </span><span class=n>println</span><span class=o>!</span><span class=p>(</span><span class=w>
</span><span class=w>        </span><span class=s>&#34;The area of the rectangle is {} square pixels.&#34;</span><span class=p>,</span><span class=w>
</span><span class=w>        </span><span class=n>rect1</span><span class=p>.</span><span class=n>area</span><span class=p>()</span><span class=w>
</span><span class=w>    </span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span></code></pre></div><p>Rust 支持自动引用和解引用，所以调用方法时，使用 <code>.</code>，而没有 <code>-></code> 运算符。
对于方法调用 <code>object.something()</code>，Rust 自动添加 <code>&, &mut, *</code> 来传递实例参数。</p><h1 id=错误处理>错误处理</h1><h2 id=不可恢复错误-panic>不可恢复错误 <code>panic!</code></h2><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=n>panic</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;crash and burn&#34;</span><span class=p>);</span><span class=w>
</span></code></pre></div><p>发生不可恢复错误时，Rust 默认会沿调用堆栈进行回溯，这会带来额外工作量，另一种选择是直接终止。</p><div class=highlight><pre class=chroma><code class=language-toml data-lang=toml><span class=p>[</span><span class=nx>profile</span><span class=p>.</span><span class=nx>release</span><span class=p>]</span>
<span class=nx>panic</span> <span class=p>=</span> <span class=s1>&#39;abort&#39;</span>
</code></pre></div><p>查看调用栈（需启用调试符号）：</p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh>$ <span class=nv>RUST_BACKTRACE</span><span class=o>=</span><span class=m>1</span> cargo run
</code></pre></div><h2 id=可恢复错误-resultt-e>可恢复错误 <code>Result&lt;T, E></code></h2><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=k>enum</span> <span class=nb>Result</span><span class=o>&lt;</span><span class=n>T</span><span class=p>,</span><span class=w> </span><span class=n>E</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=nb>Ok</span><span class=p>(</span><span class=n>T</span><span class=p>),</span><span class=w>
</span><span class=w>    </span><span class=nb>Err</span><span class=p>(</span><span class=n>E</span><span class=p>),</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span></code></pre></div><p>使用模式匹配处理：</p><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=k>use</span><span class=w> </span><span class=n>std</span>::<span class=n>fs</span>::<span class=n>File</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>std</span>::<span class=n>io</span>::<span class=n>ErrorKind</span><span class=p>;</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>File</span>::<span class=n>open</span><span class=p>(</span><span class=s>&#34;hello.txt&#34;</span><span class=p>);</span><span class=w>
</span><span class=w>
</span><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>match</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=nb>Ok</span><span class=p>(</span><span class=n>file</span><span class=p>)</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>file</span><span class=p>,</span><span class=w>
</span><span class=w>        </span><span class=nb>Err</span><span class=p>(</span><span class=n>error</span><span class=p>)</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=k>match</span><span class=w> </span><span class=n>error</span><span class=p>.</span><span class=n>kind</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>            </span><span class=n>ErrorKind</span>::<span class=n>NotFound</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=k>match</span><span class=w> </span><span class=n>File</span>::<span class=n>create</span><span class=p>(</span><span class=s>&#34;hello.txt&#34;</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>                </span><span class=nb>Ok</span><span class=p>(</span><span class=n>fc</span><span class=p>)</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>fc</span><span class=p>,</span><span class=w>
</span><span class=w>                </span><span class=nb>Err</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>panic</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;Problem creating the file: {:?}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>),</span><span class=w>
</span><span class=w>            </span><span class=p>},</span><span class=w>
</span><span class=w>            </span><span class=n>other_error</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>                </span><span class=n>panic</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;Problem opening the file: {:?}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>other_error</span><span class=p>)</span><span class=w>
</span><span class=w>            </span><span class=p>}</span><span class=w>
</span><span class=w>        </span><span class=p>},</span><span class=w>
</span><span class=w>    </span><span class=p>};</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span></code></pre></div><ul><li><code>unwrap_or_else(|error|{})</code> 提供错误处理逻辑</li><li><code>unwrap()</code> 发生错误时立即 <code>panic!</code></li><li><code>expect(message)</code> 发生错误时立即 <code>panic!(message)</code></li></ul><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=k>use</span><span class=w> </span><span class=n>std</span>::<span class=n>fs</span>::<span class=n>File</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>std</span>::<span class=n>io</span>::<span class=n>ErrorKind</span><span class=p>;</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>File</span>::<span class=n>open</span><span class=p>(</span><span class=s>&#34;hello.txt&#34;</span><span class=p>).</span><span class=n>unwrap_or_else</span><span class=p>(</span><span class=o>|</span><span class=n>error</span><span class=o>|</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=n>error</span><span class=p>.</span><span class=n>kind</span><span class=p>()</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>ErrorKind</span>::<span class=n>NotFound</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>            </span><span class=n>File</span>::<span class=n>create</span><span class=p>(</span><span class=s>&#34;hello.txt&#34;</span><span class=p>).</span><span class=n>unwrap_or_else</span><span class=p>(</span><span class=o>|</span><span class=n>error</span><span class=o>|</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>                </span><span class=n>panic</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;Problem creating the file: {:?}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>error</span><span class=p>);</span><span class=w>
</span><span class=w>            </span><span class=p>})</span><span class=w>
</span><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>            </span><span class=n>panic</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;Problem opening the file: {:?}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>error</span><span class=p>);</span><span class=w>
</span><span class=w>        </span><span class=p>}</span><span class=w>
</span><span class=w>    </span><span class=p>});</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span></code></pre></div><h3 id=错误传播>错误传播</h3><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=k>use</span><span class=w> </span><span class=n>std</span>::<span class=n>fs</span>::<span class=n>File</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>std</span>::<span class=n>io</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>std</span>::<span class=n>io</span>::<span class=n>Read</span><span class=p>;</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>fn</span> <span class=nf>read_username_from_file</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nb>Result</span><span class=o>&lt;</span><span class=nb>String</span><span class=p>,</span><span class=w> </span><span class=n>io</span>::<span class=n>Error</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>File</span>::<span class=n>open</span><span class=p>(</span><span class=s>&#34;hello.txt&#34;</span><span class=p>);</span><span class=w>
</span><span class=w>
</span><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>match</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=nb>Ok</span><span class=p>(</span><span class=n>file</span><span class=p>)</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>file</span><span class=p>,</span><span class=w>
</span><span class=w>        </span><span class=nb>Err</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=nb>Err</span><span class=p>(</span><span class=n>e</span><span class=p>),</span><span class=w>
</span><span class=w>    </span><span class=p>};</span><span class=w>
</span><span class=w>
</span><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>String</span>::<span class=n>new</span><span class=p>();</span><span class=w>
</span><span class=w>
</span><span class=w>    </span><span class=k>match</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>read_to_string</span><span class=p>(</span><span class=o>&amp;</span><span class=k>mut</span><span class=w> </span><span class=n>s</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=nb>Ok</span><span class=p>(</span><span class=n>_</span><span class=p>)</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=nb>Ok</span><span class=p>(</span><span class=n>s</span><span class=p>),</span><span class=w>
</span><span class=w>        </span><span class=nb>Err</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=nb>Err</span><span class=p>(</span><span class=n>e</span><span class=p>),</span><span class=w>
</span><span class=w>    </span><span class=p>}</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>fn</span> <span class=nf>read_username_from_file2</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nb>Result</span><span class=o>&lt;</span><span class=nb>String</span><span class=p>,</span><span class=w> </span><span class=n>io</span>::<span class=n>Error</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>File</span>::<span class=n>open</span><span class=p>(</span><span class=s>&#34;hello.txt&#34;</span><span class=p>)</span><span class=o>?</span><span class=p>;</span><span class=w>
</span><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>String</span>::<span class=n>new</span><span class=p>();</span><span class=w>
</span><span class=w>    </span><span class=n>f</span><span class=p>.</span><span class=n>read_to_string</span><span class=p>(</span><span class=o>&amp;</span><span class=k>mut</span><span class=w> </span><span class=n>s</span><span class=p>)</span><span class=o>?</span><span class=p>;</span><span class=w>
</span><span class=w>    </span><span class=nb>Ok</span><span class=p>(</span><span class=n>s</span><span class=p>)</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>fn</span> <span class=nf>read_username_from_file3</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nb>Result</span><span class=o>&lt;</span><span class=nb>String</span><span class=p>,</span><span class=w> </span><span class=n>io</span>::<span class=n>Error</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>String</span>::<span class=n>new</span><span class=p>();</span><span class=w>
</span><span class=w>
</span><span class=w>    </span><span class=n>File</span>::<span class=n>open</span><span class=p>(</span><span class=s>&#34;hello.txt&#34;</span><span class=p>)</span><span class=o>?</span><span class=p>.</span><span class=n>read_to_string</span><span class=p>(</span><span class=o>&amp;</span><span class=k>mut</span><span class=w> </span><span class=n>s</span><span class=p>)</span><span class=o>?</span><span class=p>;</span><span class=w>
</span><span class=w>
</span><span class=w>    </span><span class=nb>Ok</span><span class=p>(</span><span class=n>s</span><span class=p>)</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span></code></pre></div><p><code>?</code> 运算符：能被使用在返回 <code>Result</code> 的函数中。发生错误时，返回 <code>Err(e)</code>，使用定义在 <code>From</code> 特征中的 <code>from</code> 函数实现错误类型的转换。</p><p>在 <code>main</code> 函数中使用 <code>?</code> 运算符。</p><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=k>use</span><span class=w> </span><span class=n>std</span>::<span class=n>error</span>::<span class=n>Error</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>std</span>::<span class=n>fs</span>::<span class=n>File</span><span class=p>;</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nb>Result</span><span class=o>&lt;</span><span class=p>(),</span><span class=w> </span><span class=nb>Box</span><span class=o>&lt;</span><span class=n>dyn</span><span class=w> </span><span class=n>Error</span><span class=o>&gt;&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>File</span>::<span class=n>open</span><span class=p>(</span><span class=s>&#34;hello.txt&#34;</span><span class=p>)</span><span class=o>?</span><span class=p>;</span><span class=w>
</span><span class=w>
</span><span class=w>    </span><span class=nb>Ok</span><span class=p>(())</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span></code></pre></div></section><footer class=article-footer><section class=article-tags><a href=/tags/rust/>Rust</a>
<a href=/tags/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/>编程语言</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css integrity=sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js integrity=sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js integrity=sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.querySelector(`.article-content`),{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script></article><aside class=related-contents--wrapper><h2 class=section-title>Related contents</h2><div class=related-contents><div class="flex article-list--tile"><article><a href=/posts/learning/rust-functional/><div class=article-details><h2 class=article-title>Rust 函数式编程</h2></div></a></article><article><a href=/posts/learning/rust-generic-types/><div class=article-details><h2 class=article-title>Rust 泛型</h2></div></a></article><article><a href=/posts/learning/rust-collections/><div class=article-details><h2 class=article-title>Rust 集合</h2></div></a></article><article><a href=/posts/learning/rust-modules/><div class=article-details><h2 class=article-title>Rust 模块与项目</h2></div></a></article><article><a href=/posts/learning/rust-onwership/><div class=article-details><h2 class=article-title>Rust 所有权特性</h2></div></a></article></div></div></aside><script src=https://utteranc.es/client.js repo=StardustDL/stardustdl.github.io issue-term=pathname label=comment crossorigin=anonymous async></script><style>.utterances{max-width:unset}</style><script>function setUtterancesTheme(b){let a=document.querySelector('.utterances iframe');a&&a.contentWindow.postMessage({type:'set-theme',theme:`github-${b}`},'https://utteranc.es')}addEventListener('message',a=>{if(a.origin!=='https://utteranc.es')return;setUtterancesTheme(document.documentElement.dataset.scheme)}),window.addEventListener('onColorSchemeChange',a=>{setUtterancesTheme(a.detail)})</script><footer class=site-footer><section class=copyright>&copy;
2017 -
2021 StardustDL's Blog</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=2.5.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous></main><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#安装>安装</a><ol><li><a href=#常用命令>常用命令</a></li></ol></li><li><a href=#变量>变量</a></li><li><a href=#类型>类型</a></li><li><a href=#结构体>结构体</a><ol><li><a href=#定义>定义</a></li><li><a href=#实例化>实例化</a></li><li><a href=#成员修改>成员修改</a></li><li><a href=#基于现有结构更新>基于现有结构更新</a></li></ol></li><li><a href=#枚举>枚举</a><ol><li><a href=#简单枚举>简单枚举</a></li><li><a href=#数据枚举>数据枚举</a></li></ol></li><li><a href=#控制流>控制流</a></li><li><a href=#模式匹配>模式匹配</a><ol><li><a href=#模式>模式</a></li><li><a href=#匹配>匹配</a></li></ol></li><li><a href=#函数>函数</a></li><li><a href=#关联函数>关联函数</a></li><li><a href=#方法>方法</a></li><li><a href=#错误处理>错误处理</a><ol><li><a href=#不可恢复错误-panic>不可恢复错误 <code>panic!</code></a></li><li><a href=#可恢复错误-resultt-e>可恢复错误 <code>Result&lt;T, E></code></a><ol><li><a href=#错误传播>错误传播</a></li></ol></li></ol></li></ol></nav></div></section></aside></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous defer></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const a=document.createElement('link');a.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",a.type="text/css",a.rel="stylesheet",document.head.appendChild(a)})()</script></body></html>