{"Id":"Tools/psake","Type":2,"Author":"","Content":{"Tag":"","Raw":"\n# \u57FA\u672C\u4FE1\u606F\n\n[psake](https://github.com/psake/psake) \u662F\u4E00\u4E2A\u81EA\u52A8\u5316\u6784\u5EFA\u5DE5\u5177\uFF0C\u57FA\u4E8E PowerShell \u6784\u5EFA\uFF0C\u63D0\u4F9B\u4E86\u7C7B\u4F3C Make \u7684\u6784\u5EFA\u529F\u80FD\u3002\n\n# \u5B89\u88C5\n\n\u0060\u0060\u0060ps1\n# Set-PSRepository -Name PSGallery -InstallationPolicy Trusted\nInstall-Module -Name psake\n\u0060\u0060\u0060\n\n# \u4F7F\u7528\n\n\u521B\u5EFA \u0060psakefile.ps1\u0060\uFF0C\u7136\u540E\u4F7F\u7528\u4EE5\u4E0B\u547D\u4EE4\n\n\u0060\u0060\u0060ps1\nInvoke-psake\n\n# Get-Help Invoke-psake -full\n\u0060\u0060\u0060\n\n# psakefile \u7ED3\u6784\n\n|Function|Description|Required|\n|--------|-----------|--------|\n|_Include()_|Call this function to have psake include the functions of another file into your script|no|\n|_Properties()_|Call this function to set your properties|no|\n|_Task()_|This is the main function that you write to execute a step in your build script. NOTE: There can be only one task function that is named \u0022default\u0022 in your psake script and it cannot contain any code. psake will throw an exception if it finds more than one default task function or if the default task function contains code|yes|\n|_Exec()_|Call a command-line program and throw an exception if it returns a non-zero DOS exit code|no|\n|_Assert()_|Use to simplify writing conditional statements|no|\n|_FormatTaskName()_|Allows you to reformat how psake displays the currently running task|no|\n|_TaskSetup()_|A function that will run before each task is executed|no|\n|_TaskTearDown()_|A function that will run after each task|no|\n|_BuildSetup()_|A script block that will run before the first task starts|no|\n|_BuildTearDown()_|A script block that will run when either all tasks have completed, or the build has failed|no|\n\nBNF:\n\n\n\u0060\u0060\u0060\n\u003CBuildScript\u003E ::= \u003CIncludes\u003E \n                | \u003CProperties\u003E\n                | \u003CFormatTaskName\u003E \n                | \u003CBuildSetup\u003E \n                | \u003CTaskSetup\u003E \n                | \u003CTaskTearDown\u003E \n                | \u003CTasks\u003E \n\u003CIncludes\u003E ::= Include \u003CStringLiteral\u003E | \u003CIncludes\u003E\n\u003CProperties\u003E ::= Properties \u003CScriptBlock\u003E | \u003CProperties\u003E\n\u003CFormatTaskName\u003E ::= FormatTaskName \u003CStringliteral\u003E\n\u003CBuildSetup\u003E ::= BuildSetup \u003CScriptBlock\u003E\n\u003CBuildTearDown\u003E ::= BuildTearDown \u003CScriptBlock\u003E\n\u003CTaskSetup\u003E ::= TaskSetup \u003CScriptBlock\u003E\n\u003CTaskTearDown\u003E ::= TaskTearDown \u003CScriptBlock\u003E\n\u003CTasks\u003E ::= Task \u003CTaskParameters\u003E | \u003CTasks\u003E\n\u003CTaskParameters\u003E ::= -Name \u003CStringLiteral\u003E \n\t\t\t| -Action \u003CScriptBlock\u003E \n\t\t\t| -PreAction \u003CScriptBlock\u003E \n\t\t\t| -PostAction \u003CScriptBlock\u003E \n\t\t\t| -PreCondition \u003CScriptBlock\u003E\n\t\t\t| -PostCondition \u003CScriptBlock\u003E\n\t\t\t| -ContinueOnError \u003CBoolean\u003E\n\t\t\t| -Depends \u003CTaskNames\u003E\n\t\t\t| -Description \u003CStringLiteral\u003E\n\u003CTaskNames\u003E ::= \u003CStringLiteral\u003E, | \u003CTaskNames\u003E\t\t\t\t\n\u003CScriptBlock\u003E ::= { \u003CPowerShellStatements\u003E }\n\u003CBoolean\u003E ::= $true | $false\n\u0060\u0060\u0060\n\n# \u5E38\u89C1\u6A21\u5F0F\n\n\u0060\u0060\u0060ps1\nTask default -Depends Test\n\nTask Test -Depends Compile, Clean {\n  \u0022This is a test\u0022\n}\n\nTask Compile -Depends Clean {\n  \u0022Compile\u0022\n}\n\nTask Clean -ContinueOnError {\n  \u0022Clean\u0022\n}\n\u0060\u0060\u0060\n\n# \u4F20\u9012\u53C2\u6570\u548C\u5C5E\u6027\n\n\u8C03\u7528\uFF1A\n\n\u0060\u0060\u0060ps1\nInvoke-psake .\\parameters.ps1 -parameters @{\u0022p1\u0022=\u0022v1\u0022;\u0022p2\u0022=\u0022v2\u0022}\n\u0060\u0060\u0060\n\n\u4F20\u9012\u7684\u53C2\u6570\u4F1A\u4F5C\u4E3A\u811A\u672C\u7684\u53D8\u91CF\u3002\n\npsakefile\uFF1A\n\n\u0060\u0060\u0060ps1\nproperties {\n  $my_property = $p1 \u002B $p2\n}\n\ntask default -depends TestParams\n\ntask TestParams { \n  Assert ($my_property -ne $null) \u0027$my_property should not be null\u0027  \n}\n\u0060\u0060\u0060\n\n\u8986\u76D6\u9884\u5B9A\u4E49\u5C5E\u6027\uFF1A\n\n\u0060\u0060\u0060ps1\nInvoke-psake .\\properties.ps1 -properties @{\u0022x\u0022=\u00221\u0022;\u0022y\u0022=\u00222\u0022}\n\u0060\u0060\u0060\n\n# \u6761\u4EF6\u8FD0\u884C\n\n\u0060\u0060\u0060ps1\ntask default -depends A,B,C\n\ntask A {\n  \u0022TaskA\u0022\n}\n\ntask B -precondition { return $false } {\n  \u0022TaskB\u0022\n}\n\ntask C -precondition { return $true } {\n  \u0022TaskC\u0022\n}\n\u0060\u0060\u0060\n\n# \u5BFC\u5165\u5916\u90E8\u811A\u672C\n\n\u0060\u0060\u0060ps1\nInclude \u0022.\\build_utils.ps1\u0022\n\u0060\u0060\u0060\n\n# \u8C03\u7528\u547D\u4EE4\u884C\u5DE5\u5177\n\n\u0060\u0060\u0060ps1\nExec -maxRetries 3 -retryTriggerErrorPattern \u0022Service is not currently available.\u0022 { dotnet build }\n\u0060\u0060\u0060\n\n# \u53C2\u8003\u8D44\u6599\n\n- [psake Document](https://psake.readthedocs.io/en/latest/)\n"},"Title":"psake","Category":{"Items":["Tools"]},"Keywords":{"Items":[]},"CreationTime":"2020-07-24T19:30:40+08:00","ModificationTime":"2020-07-24T19:30:40+08:00"}