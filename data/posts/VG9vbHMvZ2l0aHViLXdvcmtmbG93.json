{"Id":"Tools/github-workflow","Type":2,"Author":"","Content":{"Tag":"","Raw":"\n# \u57FA\u672C\u4FE1\u606F\n\nGitHub Actions \u4E2D\u7684 Workflow \u63D0\u4F9B\u4E86\u57FA\u4E8E\u4ED3\u5E93\u76F8\u5173\u4E8B\u4EF6\u9A71\u52A8\u7684\u5DE5\u4F5C\u6D41\uFF0C\u53EF\u4EE5\u57FA\u4E8E\u6B64\u5B9E\u73B0\u6301\u7EED\u96C6\u6210\uFF0C\u6301\u7EED\u90E8\u7F72\u7B49\u529F\u80FD\u3002\n\n# \u57FA\u7840\u4F7F\u7528\n\n\u0060\u0060\u0060yml\n# Trigger event\non:\n  # Trigger the workflow on push or pull request,\n  # but only for the master branch\n  push:\n    branches:\n      - master\n  pull_request:\n\n# global env variables\nenv:\n  SERVER: production\n\n# default config\ndefaults:\n  run:\n    shell: bash\n    working-directory: scripts\n\n# all jobs\njobs:\n  job1:\n    name: My first job\n    runs-on: ubuntu-latest\n  job2:\n    name: My second job\n    needs: job1\n    strategy:\n      matrix:\n          node: [6, 8, 10]\n    env:\n    defaults:\n    # When set to true, GitHub cancels all in-progress jobs if any matrix job fails.\n    fail-fast: true\n    # Prevents a workflow run from failing when a job fails. Set to true to allow a workflow run to pass when this job fails.\n    continue-on-error: false \n    if: ${{ true }}\n    steps:\n    - name: Print a greeting\n      if: ${{ true }}\n      env:\n      working-directory: ./temp\n      run: |\n        echo $MY_VAR $FIRST_NAME $MIDDLE_NAME $LAST_NAME.\n      shell: bash\n    - # use extenal actions\n      name: My first step\n      uses: actions/hello_world@master\n      with:\n        first_name: Mona\n        middle_name: The\n        last_name: Octocat  \n    - uses: actions/setup-node@v1\n      with:\n        # The Node.js version to configure\n        node-version: ${{ matrix.node }}\n\u0060\u0060\u0060\n\n# \u4F7F\u7528\u654F\u611F\u6570\u636E\n\n\u5728\u4ED3\u5E93\u8BBE\u7F6E\u9875\u9762\u7684 \u0060Secrets\u0060 \u90E8\u5206\u6DFB\u52A0\u654F\u611F\u6570\u636E\u3002\n\n\u0060\u0060\u0060yml\n- name: CI\n  env:\n    NUGET_AUTH_TOKEN: ${{ secrets.AZ_TOKEN }}\n  run: Invoke-psake ci -parameters @{ \u0022NUGET_AUTH_TOKEN\u0022 = $env:NUGET_AUTH_TOKEN }\n\u0060\u0060\u0060\n\n# \u4E0A\u4F20\u6587\u4EF6\n\n\u0060\u0060\u0060yml\n- name: Upload reports\n  uses: actions/upload-artifact@v2\n  with:\n    name: ci-${{ matrix.os }}\n    path: ./reports\n\u0060\u0060\u0060\n\n# \u542F\u52A8\u5916\u90E8\u5DE5\u4F5C\u6D41\n\nCaller:\n\n\u0060\u0060\u0060yml\ninvoke-cd:\n  needs: ci\n  runs-on: ubuntu-latest\n  if: ${{ github.event_name == \u0027push\u0027 \u0026\u0026 github.ref == \u0027refs/heads/master\u0027 }}\n  steps:\n  - name: Repository Dispatch\n    uses: peter-evans/repository-dispatch@v1\n    with:\n      token: ${{ secrets.PA_TOKEN }}\n      event-type: cd\n\u0060\u0060\u0060\n\nCallee:\n\n\u0060\u0060\u0060yml\non:\n  repository_dispatch:\n    types: [cd]\n\u0060\u0060\u0060\n\n# \u6784\u5EFA\u5E76\u63A8\u9001 Docker \u955C\u50CF\n\n\u0060\u0060\u0060yml\n- name: Push image\n  uses: docker/build-push-action@v1\n  with:\n    username: ${{ secrets.DOCKER_USERNAME }}\n    password: ${{ secrets.DOCKER_PASSWORD }}\n    repository: repo_name\n    tag_with_ref: true\n    dockerfile: ./Dockerfile\n\u0060\u0060\u0060\n\n# \u53C2\u8003\u8D44\u6599\n\n- [GitHub Actions Document](https://docs.github.com/en/actions)"},"Title":"GitHub Actions - Workflow","Category":{"Items":["Tools"]},"Keywords":{"Items":[]},"CreationTime":"2020-07-24T18:30:40+08:00","ModificationTime":"2020-07-24T18:30:40+08:00"}